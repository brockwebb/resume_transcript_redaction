# Identity-related terms to be redacted to prevent potential bias.
identity_terms:
  - "pronouns"
  - "they/them"
  - "she/her"
  - "he/him"
  - "lgbtqia+"
  - "transgender"
  - "female"
  - "male"
  - "nonbinary"
  - "gender"
  - "identity"
  - "advocacy"

# Race and ethnicity terms to identify and redact sensitive descriptors.
race_ethnicity_terms:
  - "Asian"
  - "Black"
  - "African American"
  - "Hispanic"
  - "Latino"
  - "White"
  - "Caucasian"
  - "Native American"
  - "Pacific Islander"
  - "Middle Eastern"
  - "Multiracial"
  - "Biracial"

# Protected categories aligned with ADA and federal law.
protected_categories:
  # Standard protected categories
  - "disability"
  - "mental health"
  - "physical health"
  - "pregnancy"
  - "veteran"
  - "military status"
  - "religion"
  - "creed"
  - "age"
  - "sexual orientation"
  - "marital status"
  - "familial status"
  - "genetic information"

# Medical terms as custom patterns for better context control
custom_patterns:
  - name: "medical_disclosure"
    regex: "(?i)medical\\s+disclosure:.*|(?:requires|needs|medical)\\s+accommodations?.*"
    score: 0.95
    entity_type: "MEDICAL_DISCLOSURE"

  - name: "personal_health_info"
    regex: "(?i)(?:diagnosed|suffering|treated)\\s+(?:with|for)\\s+|(?:type|stage)\\s*[0-9]\\s+[a-zA-Z\\s]+|(?:insulin|medication)\\s+(?:pump|treatment|therapy)"
    score: 0.95
    entity_type: "PHI"

  - name: "social_media"
    regex: "(?i)(?:twitter|linkedin|facebook|instagram):\\s*@?[\\w\\-]+"
    score: 0.75
    entity_type: "SOCIAL_MEDIA"
    
  # Standard contact/location patterns
  - name: "address"
    regex: "\\d{1,5}\\s[A-Za-z0-9\\.\\,\\-\\s]+,\\s[A-Za-z]+,\\s[A-Z]{2}\\s\\d{5}"
    score: 0.75
    entity_type: "ADDRESS"
    
  - name: "zip_code"
    regex: "\\b\\d{5}(-\\d{4})?\\b"
    score: 0.85
    entity_type: "ZIP_CODE"

  - name: "email"
    regex: "[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}"
    score: 0.9
    entity_type: "EMAIL_ADDRESS"

  - name: "url"
    regex: "(?i)(?<!@)(?:https?://)?(?:www\\.)?[a-zA-Z0-9][a-zA-Z0-9-]{1,61}[a-zA-Z0-9]\\.[a-zA-Z]{2,}(?:/[^\\s]*)?"
    score: 0.8
    entity_type: "URL"

  - name: "titles"
    regex: "\\b(Mr|Ms|Miss|Mrs|Dr|Prof|Sir|Madam|Mx)\\.?\\b"
    score: 0.65
    entity_type: "TITLE"

# Miscellaneous patterns for catching additional sensitive information
  - name: "certification"
    regex: "[A-Z][a-z]+ Certification"
    score: 0.8
    entity_type: "CERTIFICATION"

  - name: "license_number"
    regex: "[A-Z0-9\\-]+"
    score: 0.85
    entity_type: "LICENSE_NUMBER"

  - name: "social_security_number"
    regex: "\\d{3}-\\d{2}-\\d{4}"
    score: 0.8
    entity_type: "SSN"

  - name: "passport_number"
    regex: "[A-Z0-9]{5,9}"
    score: 0.8
    entity_type: "PASSPORT_NUMBER"

  - name: "phone_number"
    regex: "(?:\\+?\\d{1,2}[-.]?)?\\(?\\d{3}\\)?[-.]?\\d{3}[-.]?\\d{4}"
    score: 0.8
    entity_type: "PHONE_NUMBER"

  - name: "medical_disclosure"
    regex: "(?i)(medical|health)\\s*(disclosure|condition|status).*"
    score: 0.9
    entity_type: "MEDICAL_DISCLOSURE"

  - name: "medical_accommodation"
    regex: "(?i)requires?\\s*(medical\\s*)?accommodations?.*"
    score: 0.9
    entity_type: "MEDICAL_ACCOMMODATION"

  - name: "health_condition"
    regex: "(?i)(chronic|ongoing|diagnosed with|suffering from|treated for)\\s*\\w+\\s*(condition|disease|disorder|syndrome)"
    score: 0.9
    entity_type: "HEALTH_CONDITION"

# Custom patterns for fine-tuning PII detection and redaction.
  - name: "phone_formats"
    regex: "(?:\\+?\\d{1,2}[-\\s.]?)?(?:\\(?\\d{3}\\)?[-\\s.]?)?\\d{3}[-\\s.]?\\d{4}"
    score: 0.9
    entity_type: "PHONE_NUMBER"

  - name: "birth_date"
    regex: "(Date\\s+of\\s+Birth:|DOB:)?\\s*\\d{2}/\\d{2}/\\d{4}"
    score: 0.9
    entity_type: "DATE_OF_BIRTH"

  - name: "education_institution"
    regex: "(University|College)\\s+of\\s+[A-Za-z\\s]+"
    score: 0.8
    entity_type: "UNIVERSITY"

  - name: "gpa"
    regex: "GPA[:\\s]\\s?\\d\\.\\d{1,2}\\s?\\/\\s?4\\.0"
    score: 0.9
    entity_type: "GPA"
    
  - name: "name_with_special_chars"
    regex: "(?i)[A-Za-z]+[-\\s](?:[A-Za-z]+|tech|dev|inc|llc)"
    score: 0.9
    entity_type: "NAME"

  - name: "twitter_handle"
    regex: "(?i)(?:twitter:?\\s*)?\\**\\s*@[a-zA-Z0-9_-]{1,20}\\**"
    score: 0.9
    entity_type: "SOCIAL_HANDLE"
    
  - name: "developer_handle"
    regex: "(?i)(?:[A-Za-z]+[-.])?(?:dev|developer|tech|coder|programmer|engineer)"
    score: 0.85
    entity_type: "PROFESSIONAL_HANDLE"

